<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>信息系统安全学习 | LowBee's Blog</title><meta name="keywords" content="专业,协议"><meta name="author" content="Low Bee"><meta name="copyright" content="Low Bee"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="做有一个学生该做的事——准备考试…GO！">
<meta property="og:type" content="article">
<meta property="og:title" content="信息系统安全学习">
<meta property="og:url" content="http://lowbee.fun/2020/06/16/%E4%BF%A1%E6%81%AF%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E5%AD%A6%E4%B9%A0/index.html">
<meta property="og:site_name" content="LowBee&#39;s Blog">
<meta property="og:description" content="做有一个学生该做的事——准备考试…GO！">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/lowbee2019/PicGo@master/img/bg1.jpg">
<meta property="article:published_time" content="2020-06-15T16:00:00.000Z">
<meta property="article:modified_time" content="2021-04-25T05:13:31.783Z">
<meta property="article:author" content="Low Bee">
<meta property="article:tag" content="专业">
<meta property="article:tag" content="协议">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/lowbee2019/PicGo@master/img/bg1.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://lowbee.fun/2020/06/16/%E4%BF%A1%E6%81%AF%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E5%AD%A6%E4%B9%A0/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-197495331-1"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-197495331-1');
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-04-25 13:13:31'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/lowbee2019/PicGo@master/img/头像.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">70</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">40</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">8</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/gh/lowbee2019/PicGo@master/img/bg1.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">LowBee's Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">信息系统安全学习</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2020-06-15T16:00:00.000Z" title="Created 2020-06-16 00:00:00">2020-06-16</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2021-04-25T05:13:31.783Z" title="Updated 2021-04-25 13:13:31">2021-04-25</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">8.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>29min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="信息系统安全学习"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><img src="https://cdn.jsdelivr.net/gh/lowbee2019/PicGo@master/img/bg1.jpg" alt=""></p>
<p>做有一个学生该做的事——准备考试…GO！</p>
<span id="more"></span>
<h2 id="客观题">客观题</h2>
<h3 id="选择">选择</h3>
<ul>
<li>第2章信息安全经典模型、第4章身份认证机制</li>
<li>第1、3章部分内容</li>
<li>涉及第5、7章</li>
<li>可信计算：第3章和第9.3节</li>
<li><strong>B卷</strong>增加实验报告部分</li>
<li>PKI-CA的职责是什么：签发和管理证书</li>
<li>可以用于密钥交换的算法或困难假设：RSA、ECC、Diff-Hallman、RC4</li>
<li>WPA的认证方式</li>
</ul>
<h3 id="填空">填空</h3>
<ul>
<li>
<p>安全绪论：攻击方式、计算机病毒的阶段</p>
</li>
<li>
<p>可信计算：安全等级：美国国防4类7级，A1安全等级最高</p>
</li>
<li>
<p>密钥交换协议：DH安全性基于离散对数</p>
</li>
<li>
<p>经典的认证方式：用户名-口令，基于PKI的AKE，基于哈希摘要的认证</p>
</li>
<li>
<p>身份认证机制：防(主动、<s>被动</s>)攻击</p>
</li>
</ul>
<blockquote>
<h3 id="客观题整理-感谢-Steve·Curcy">客观题整理 感谢@<a target="_blank" rel="noopener" href="https://github.com/CNGtheshy">Steve·Curcy</a></h3>
<ol>
<li>
<p>计算机病毒生命周期一般包括<u>潜伏阶段、传播阶段、触发阶段、发作阶段</u></p>
</li>
<li>
<p>网络信息安全攻击的阶段：<u>侦查、扫描、获取访问、维持访问和掩盖行踪</u></p>
</li>
<li>
<p>身份认证可以防止<u>主动攻击</u>，可以分为<u>身份标识</u>和<u>身份认证</u>两个部分</p>
</li>
<li>
<p>秘钥交换协议Diffie-Hallman基于<u>离散对数</u>的困难问题</p>
</li>
<li>
<p>经典的认证方式有哪些：<u>基于口令的身份认证、使用基于PKI的AKE认证、基于哈希摘要的认证、基于生物特征的身份认证、基于位置的身份认证、质询-响应式身份认证</u>（主要记住前三个）</p>
</li>
<li>
<p>PKICA的核心职责是什么：<u>签发和管理证书</u>；哪个算法或困难假设可以用到秘钥交换：<u>RSA、ECC、Diff-hallman、RC4</u></p>
</li>
<li>
<p>WIFI网络安全接入是一种保护无线网络安全的系统，WPA加密的认证方式包括<u>WPA、WPA2、WPA-PSK、WPA2-PSK</u></p>
</li>
<li>
<p>Kerberos秘钥分发服务包括哪些服务(KDC提供的服务)：<u>票证授予服务，身份验证服务，账号存储服务</u>。<br>
8.1.	身份验证服务器AS(Authentication Service)：AS实现对Client身份的确认，并颁发给该Client一个TGT（Ticket Granting Ticket认购权证）。</p>
<p>8.2.	票证授予服务TGS（Ticket Granting Service）：通过Client向KDC中的TGS发送Ticket Granting Service Request（KRB_TGS_REQ）开始。</p>
<p>8.3. 账号数据库AD(Account Database)：对账号进行管理和存储，设置黑白名单，用于AS认证过程。</p>
</li>
<li>
<p>安全电子交易协议SET是什么、可以干嘛，有什么基本原理，工作机制<br>
9.1.	SSL提供的安全内容：<u>机密性、完整性和认证性</u><br>
9.2.	SET协议（Secure Electronic Transaction），全名为安全电子交易协议，是一种以信用卡为基础的在因特网上交易的付款协议。<br>
9.3.	SET协议的基本原理：SET中引入的一个重要的创新—<u>双重签名</u>，它可以巧妙地把发送给不同的接收者的两条消息联系起来，而又很好地保护了消费者的隐私，并利用了RSA和DES等密码学算法保证其安全性。<br>
9.4.	SET协议的工作机制：<u>利用公钥体系对通信双方进行认证，用对称加密算法对信息加密传输，并用散列函数算法来鉴别信息的完整性</u><br>
9.5.	SET协议的应用：网上购物，电子信用卡，电子交易</p>
</li>
<li>
<p><u>用户的身份认证</u>是许多应用系统的第一道防线，认证技术主要是解决网络通信过程中双方的身份认可，<u>主要防主动攻击</u>。</p>
</li>
<li>
<p>完整性模型 BIBA模型和Clark-Wilson模型</p>
<table>
<thead>
<tr>
<th style="text-align:center">模型</th>
<th style="text-align:center">模型特征</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">BLP</td>
<td style="text-align:center"><strong>保密性</strong>，军事安全，中央集权信息系统、较低的执行开销</td>
</tr>
<tr>
<td style="text-align:center">BIBA</td>
<td style="text-align:center"><strong>完整性</strong>，强制访问控制，难于应用，中央集权信息系统</td>
</tr>
<tr>
<td style="text-align:center">Clark-Wilson</td>
<td style="text-align:center"><strong>完整性</strong>，商业安全，能够应用面向对象系统，与应用无关的策略、灵活</td>
</tr>
<tr>
<td style="text-align:center">Chinese Wall</td>
<td style="text-align:center"><strong>保密性</strong>，金融制度，可能有负作用，安全管理的开销较大</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>安全模型<br>
12.1.	BLP模型基于两种规则来保障数据的机密度与敏感度</p>
<p><code>BLP wirte up (no write down), read down( no read up)；上写（不下写）下读（不上读）</code></p>
<p>12.1.1.	下读规则：主体不能读安全级别高于它的数据<br>
12.1.2.	上写规则：主体不可写安全级别低于它的数据<br>
12.2.	BIBA模型基于两种规则来保障数据的完整性的保密性：</p>
<p><code>BiBa write down( no write up), read up ( no read down);  下写（不上写）上读（不下读）</code></p>
<p>12.2.1.	上读规则，主体不能读取安全级别低于它的数据<br>
12.2.2.	下写规则：主体不能写入安全级别高于它的数据</p>
<p>12.2.3.	BIBA模型并没有用来设计安全操作系统，但大多数完整性保障机制都基于Biba模型的两个基本属性构建</p>
<p>12.3.	什么是多边安全模型、有哪些 ? <u>Chinese Wall和BMA</u><br>
12.4.	哪些模型可以提供机密性保护？<u>BLP，Chinese Wall</u><br>
12.5.	哪些些模型可以提供完整性保护？<u>BIBA，Clark-Wilson</u></p>
</li>
<li>
<p>可信计算概念与需求<br>
13.1.	可信计算的概念：可信计算是在计算和通信系统中广泛使用基于硬件安全模块支持下的可信计算平台，以提高系统整体的安全性<br>
13.2.	可信计算的需求：解决计算机和网络结构上的不安全，从根本上提高安全性，确保完成计算任务的逻辑组合不被篡改和破坏，实现正确计算。<br>
13.3.	安全是指采取技术和管理的安全保护手段，保护软硬件与数据不因偶然的或恶意的原因而遭受到破坏、更改、暴露<br>
13.4.	TCSEC：可信计算机系统评估标准：分为A/B/C/D四类七个等级-D,C1,C2,B1,B2,B3,A1<br>
13.4.1.	D最小保护：只为文件和用户提供安全保护<br>
13.4.2.	C1任意安全保护（与C2同属于自主保护）<br>
13.4.3.	C2受控访问控制<br>
13.4.4.	B1标记的安全保护（B强制访问控制）<br>
13.4.5.	B2结构化保护<br>
13.4.6.	B3安全域<br>
13.4.7.	A1已验证设计（A验证保护）<strong>A1的安全等级最高</strong><br>
13.5.	CC：公共准则（ISO/IEC 15408）分为EAL1，EAL2,EAL3,EAL4,EAL5,EAL5,EAL6,EAL7<br>
13.5.1.	EAL1：功能测试<br>
13.5.2.	EAL2：结构测试<br>
13.5.3.	EAL3：方法测试和检查<br>
13.5.4.	EAL4：方法设计、测试和检查<br>
13.5.5.	EAL5：半形式设计和测试<br>
13.5.6.	EAL6：半形式验证设计和测试<br>
13.5.7.	EAL7：形式验证设计和测试 (<strong>EAL7的安全等级最高</strong>)</p>
</li>
</ol>
</blockquote>
<h2 id="主观题">主观题</h2>
<h3 id="0x01-课堂汇报-流密码">0x01 课堂汇报(流密码)</h3>
<h4 id="是什么：">是什么：</h4>
<p>流加密，是对称加密算法的一种，加密和解密双方使用相同伪随机加密数据流作为密钥。明文数据每次与密钥数据流顺次对应加密(XOR)，得到密文数据流。</p>
<h4 id="为什么">为什么:</h4>
<p>该算法解决了对称加密完善保密性的实际操作困难。由于完善保密性要求密钥长度不短于明文长度，故而实际操作存在困难，改由较短数据流通过特定算法得到密钥流。因此伪随机数生成器成为流密码的关键。</p>
<h4 id="特点：">特点：</h4>
<ul>
<li>
<p>流密码的密钥长度会与明文的长度相同。</p>
</li>
<li>
<p>流密码的密钥派生自一个较短的密钥，派生算法通常为一个伪随机数生成算法。</p>
</li>
</ul>
<h4 id="优缺点：">优缺点：</h4>
<ul>
<li>
<p>速度快，便于硬件实现，记忆性强，错误传播交轻</p>
</li>
<li>
<p>统计混乱不足，修改不敏感</p>
</li>
</ul>
<h3 id="0x02-名词解释">0x02 名词解释</h3>
<blockquote>
<p>CIA（机密性，完整性、可用性）原则</p>
<p>不可抵赖原则、认证原则、访问控制原则</p>
</blockquote>
<p>机密性（Confidentiality）指防止私密的或机密的信息泄露给非授权的实体的属性。</p>
<p>完整性（Integrity）分为数据完整性和系统完整性；数据完整性指确保数据只能按照授权的指定方式进行修改的属性；系统完整性是指系统没有受到未经授权的操控进而完好无损的执行预定功能的属性。</p>
<p>可用性（Availability）指确保系统及时工作并向授权用户提供所需服务的属性。</p>
<p>保密性原则：就是指不经过授权,不能访问或利用信息,只有发送者与接受者能访问信息内容，信息不能被截获。</p>
<p>完整性原则：就是指信息不经过授权,不能被修改的特性,即信息在传输的过程中不能被偶然或蓄意修改、删除或者插入，即不能被篡改</p>
<p>可用性原则：就是指就是信息可被授权实体访问并按需求使用的特性,不因中断等攻击停止服务或降低服务标准</p>
<p>认证原则：信息需要明确的身份证明，通过认证过程保证正确的消息来源，与信息接收方建立信任关系，缺乏认证机制可能会导致伪造</p>
<p>不可抵赖原则：信息的发送者不可否认已发出得信息</p>
<p>访问控制原则：指定与控制用户能够访问哪些信息，能够有什么样的操作，通常包括角色管理与规则管理</p>
<p><strong>补充：</strong></p>
<p>可以通过信息加密、信息隐形、夹带信息等方式来实现信息的保密性；可以通过特定得安全协议、信息摘要、密码校验与等方法实现信息的完整性；通过口令认证、认证令牌、数字证书、消息认证码、公钥算法等方式实现信息认证；通过数字签名得方法实现信息的完整性与不可抵赖性；通过用户角色认证、防火墙与IDS等方式实现访问控制与可用性原则。</p>
<h3 id="0x03-零知识证明-FS鉴别协议-DSA">0x03 零知识证明 &amp; FS鉴别协议 &amp; DSA</h3>
<h4 id="零知识证明："><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E9%9B%B6%E7%9F%A5%E8%AF%86%E8%AF%81%E6%98%8E/8804311?fr=aladdin#3">零知识证明</a>：</h4>
<p>定义：是证明者能够在不向验证者提供任何有用的信息的情况下，使验证者相信某个论断是正确的。</p>
<p>完备性：V无法欺骗P。若P知道一个定理的证明方法，则P使V以绝对优势的概率相信他能证明。</p>
<p>正确性：P无法欺骗V。换言之，若P不知道一个定理的证明方法，则P使V相信他会证明定理的概率很低。</p>
<p>零知识性：V无法获取任何额外的知识。</p>
<h4 id="Fiat-Shamir鉴别协议：">Fiat-Shamir鉴别协议：</h4>
<p>FS协议简述:证明者Alice 通过执行一个3轮协议t 次，向验证者Bob 证明其掌握知识s</p>
<ol>
<li>一次性建立过程：</li>
</ol>
<ul>
<li>
<p>信任中心T选择并公布一个RSA型的模<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mi>p</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">n = pq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span>，但将素数p，q保密</p>
</li>
<li>
<p>每一个声称者A选择一个与n互素的秘密s，1&lt;=s&lt;=n-1,计算<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>=</mo><msup><mi>s</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">v=s^2(mod n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>,并向T登记v作为公开密钥。</p>
</li>
</ul>
<ol start="2">
<li>协议执行：如下步骤循环执行t次(连续且独立)。如果t次都成功完成，B接受A证明，认为A掌握秘密s。</li>
</ol>
<ul>
<li>
<p>A选择一个随机数(承诺)r,<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>r</mi><mo>≤</mo><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">1≤r≤n-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78041em;vertical-align:-0.13597em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>,并且发送(证据)<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><msup><mi>r</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">x = r^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>（mod n）给B</p>
</li>
<li>
<p>B随机的选择一个(问题)比特e=0或者e=1，并发送e给A</p>
</li>
<li>
<p>A计算并发送B(回答)y，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mi>r</mi></mrow><annotation encoding="application/x-tex">y=r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span>(如果e=0)或者$y=rs(mod n) $(如果e=1)</p>
</li>
<li>
<p>如果y=0，B拒绝证明，否则验证了<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>y</mi><mn>2</mn></msup><mo>=</mo><mi>x</mi><msup><mi>v</mi><mi>e</mi></msup><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y^2=xv^e(mod n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> 就可以接收证明。（根据e，得<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>y</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">y^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>=x或者<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>y</mi><mn>2</mn></msup><mo>=</mo><mi>x</mi><mi>v</mi><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y^2=xv(mod n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>由于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>=</mo><msup><mi>s</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">v=s^2 (mod n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>。注意验证y=0是为了排除r=0的情况）</p>
<p>其过程如下：</p>
</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/lowbee2019/PicGo@master/img/20200616221514.png" alt=""></p>
<p><strong>评述：</strong></p>
<p>(1)可以对协议1做如下解释和非正式的证明。提问e要求A有能力回答两个问题，其中一个需要秘密s，另一个容易的问题是用来防止欺骗的。一个知道s的证明者可以回答两个问题，但是其他人最多回答一个问题，因此有1/2的可能不被发现，为了减少欺骗的可能，需要执行t次（例如t=20，t=40），降低欺骗的概率。</p>
<p>(2) A的回答y = r是独立于A的秘密s，然而回答<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mi>r</mi><mi>s</mi><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y = rs (mod n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>也没有提供任何关于s的信息，因为B 并不知道随机数r。</p>
<p>由A 产生的信息对(x，y )恰好可以作为验证者B自己很好的模拟:随机选择y，定义<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><msup><mi>y</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">x= y^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>或<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>y</mi><mn>2</mn></msup><mi mathvariant="normal">/</mi><mi>v</mi><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y^2/v (mod n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>。虽然这并不是A建立信息对的方法，但对(x，y)的概率分布实际上与A产生的对不可区分，这就是零知识属性。尽管可以模拟证明过程，B并不能冒充A，因为B并不能实时预测提问x。</p>
<blockquote>
<h4 id="讲述一个-不可能-的故事">讲述一个&quot;不可能&quot;的故事</h4>
<p>注意：上述的四个过程为一次挑战，每次挑战<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span>都不同。</p>
<p>前提：A没有掌握秘密s，但是他又想欺骗B，使后者相信自己已经掌握秘密s。</p>
<p>​		B是一个不懂FS协议的人，不知道应该进行多次挑战，结果只进行一次挑战<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">e=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>(因为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">e=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>,和秘密s无关)；A得知这个消息后，协议会如下进行：</p>
<ul>
<li>
<p>随机选择一个数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo separator="true">,</mo><mn>1</mn><mo>≤</mo><mi>y</mi><mo>≤</mo><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">y,1≤y≤n-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8304100000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>，然后计算<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><msup><mi>y</mi><mn>2</mn></msup><mi mathvariant="normal">/</mi><mi>v</mi></mrow><annotation encoding="application/x-tex">x=y^2/v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span>,将x，发送给B;</p>
</li>
<li>
<p>B-&gt;A:<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">e=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></p>
</li>
<li>
<p>A-&gt;B:<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></p>
</li>
<li>
<p>B验证:<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>y</mi><mn>2</mn></msup><mo>=</mo><mi>x</mi><mi>v</mi></mrow><annotation encoding="application/x-tex">y^2=xv</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span>,因为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><msup><mi>y</mi><mn>2</mn></msup><mi mathvariant="normal">/</mi><mi>v</mi></mrow><annotation encoding="application/x-tex">x=y^2/v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span>，所以验证结果必定为真。</p>
</li>
</ul>
<p>由此实现了A对B的欺骗。</p>
<p>​		假设B是一个懂FS协议的人，A就不知道B每次的挑战是什么，A如果还是想按照上述过程对B进行欺骗的话，会遇到一下场景：</p>
<ul>
<li>
<p>随机选择一个数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo separator="true">,</mo><mn>1</mn><mo>≤</mo><mi>y</mi><mo>≤</mo><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">y,1≤y≤n-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8304100000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>，然后计算<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><msup><mi>y</mi><mn>2</mn></msup><mi mathvariant="normal">/</mi><mi>v</mi></mrow><annotation encoding="application/x-tex">x=y^2/v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span>,将x，发送给B;</p>
</li>
<li>
<p>B-&gt;A:<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">e=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></p>
</li>
<li>
<p>A-&gt;B:??? who can tell me ?</p>
</li>
</ul>
<p>此时A 应该给B发送<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span>,但是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><msqrt><mrow><msup><mi>y</mi><mn>2</mn></msup><mi mathvariant="normal">/</mi><mi>v</mi></mrow></msqrt><mo>=</mo><mi>y</mi><mi mathvariant="normal">/</mi><msqrt><mi>v</mi></msqrt></mrow><annotation encoding="application/x-tex">r=\sqrt{y^2/v}=y/\sqrt{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.24em;vertical-align:-0.30499999999999994em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.935em;"><span class="svg-align" style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span><span style="top:-2.8950000000000005em;"><span class="pstrut" style="height:3.2em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.30499999999999994em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.05028em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord">/</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8002800000000001em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span><span style="top:-2.76028em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.23972em;"><span></span></span></span></span></span></span></span></span>,而<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mi>v</mi></msqrt><mo>=</mo><mi>s</mi></mrow><annotation encoding="application/x-tex">\sqrt{v}=s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.23972em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8002800000000001em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span><span style="top:-2.76028em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.23972em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">s</span></span></span></span>,但是A不知道秘密s，所以验证失败。</p>
<h4 id="综上两种情况可见-A-在不知道秘密s的情况下，有1-2的概率成功，所以此协议需要n次挑战-A成功欺骗的概率就是1-2-n。">综上两种情况可见,A 在不知道秘密s的情况下，有1/2的概率成功，所以此协议需要n次挑战,A成功欺骗的概率就是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi mathvariant="normal">/</mi><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">1/2^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">/</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span>。</h4>
<p>就算A能力提升了，它能够预测B有限次的挑战信息，则第一步发送<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span>会有如下情况：</p>
<ul>
<li>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">e=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>===&gt;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><msup><mi>r</mi><mn>2</mn></msup><mo separator="true">,</mo><mn>1</mn><mo>≤</mo><mi>r</mi><mo>≤</mo><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x=r^2,1≤r≤n-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></p>
</li>
<li>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">e=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>===&gt;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><msup><mi>y</mi><mn>2</mn></msup><mi mathvariant="normal">/</mi><mi>v</mi><mo separator="true">,</mo><mn>1</mn><mo>≤</mo><mi>y</mi><mo>≤</mo><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x=y^2/v,1≤y≤n-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8304100000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></p>
</li>
</ul>
<p>但只要B经过足够多的挑战,依然能够验证A不知道秘密s。</p>
</blockquote>
<h4 id="DSA：">DSA：</h4>
<p>DSA方案包括初始过程、签名过程和验证过程。</p>
<p><strong>1.初始化过程：</strong></p>
<p>(1) 系统参数：全局公钥KUG：p,q,g。p,q,g 作为系统参数，供所有用户使用，在系统内公开。</p>
<p>q: 选择素数q，位长为160，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>159</mn></msup><mo>&lt;</mo><mi>q</mi><mo>&lt;</mo><msup><mn>2</mn><mn>160</mn></msup></mrow><annotation encoding="application/x-tex">2^{159}&lt; q &lt;2^{160}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.853208em;vertical-align:-0.0391em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">5</span><span class="mord mtight">9</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7335400000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">6</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>p: 随机生成L位的素数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mi>k</mi><mi>q</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p=kq+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>，这里L在512到1024之间,且为64的倍数</p>
<p>g: 随机选择整数h，计算<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>=</mo><msup><mi>h</mi><mrow><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>q</mi></mrow></msup><mi>m</mi><mi>o</mi><mi>d</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">g=h^{(p-1)/q} mod p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0824399999999998em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span><span class="mord mtight">/</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span></span></span></span>,其中1&lt;h&lt;(p−1),g&gt;1,<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>g</mi><mi>q</mi></msup><mo>≡</mo><mn>1</mn><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">g^q≡1(mod p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.858832em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></p>
<p>(2) 用户私钥：用户选取一个私钥x，x 随机或伪随机整数, 其中1≤x≤q−1</p>
<p>(3) 用户公钥：用户的公钥y，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><msup><mi>g</mi><mi>x</mi></msup><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y=g^x mod(p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span>，公开。</p>
<p><strong>2.签名过程：</strong></p>
<p>对待签消息M</p>
<p>输入：(（g,p,q,x),M) ， M为要签名的消息</p>
<p>(1) 生成一随机整数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo separator="true">,</mo><mn>0</mn><mo>&lt;</mo><mi>k</mi><mo>&lt;</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">k,0&lt;k&lt;q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span>；</p>
<p>(2) 计算<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mo stretchy="false">(</mo><msup><mi>g</mi><mi>k</mi></msup><mi>m</mi><mi>o</mi><mi>d</mi><mi>p</mi><mo stretchy="false">)</mo><mi>m</mi><mi>o</mi><mi>d</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">r=(g^k  mod p)mod q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span>；</p>
<p>(3) 计算 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><msup><mi>k</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>H</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>+</mo><mi>x</mi><mi>r</mi><mo stretchy="false">)</mo><mi>m</mi><mi>o</mi><mi>d</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">s=k^{-1}(H(m)+xr)mod q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span>。</p>
<p>则输出(r,s)为签名人对M的签名。</p>
<p>注： H(M)使用SHA-1生成的M的散列码</p>
<p>r不依赖消息，是k和全局公钥的函数。故对一个消息存在许多签名</p>
<p>离散对数的困难：<strong>从r恢复k是很困难的，从s恢复x是不可行的</strong></p>
<p><strong>3.验证过程：</strong></p>
<p>(1) 输入：((g,p,q,y),M,(r ′,s ′ ))</p>
<p>(2)计算<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>=</mo><mo stretchy="false">(</mo><msup><mi>s</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><msup><mo stretchy="false">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>m</mi><mi>o</mi><mi>d</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">w=(s&#x27;)^{-1}mod q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span></p>
<p>(3) 计算<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mn>1</mn><mo>=</mo><mo stretchy="false">[</mo><mi>H</mi><mo stretchy="false">(</mo><msup><mi>M</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo><mi>w</mi><mo stretchy="false">]</mo><mi>m</mi><mi>o</mi><mi>d</mi><mi>q</mi><mo separator="true">,</mo><mi>u</mi><mn>2</mn><mo>=</mo><mo stretchy="false">(</mo><msup><mi>r</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo><mi>w</mi><mi>m</mi><mi>o</mi><mi>d</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">u1=[H(M&#x27;)w]mod q, u2=(r&#x27;)w mod q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathnormal">u</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">]</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">u</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span></p>
<p>(4)计算<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>=</mo><mo stretchy="false">[</mo><mo stretchy="false">(</mo><msup><mi>g</mi><mrow><mi>u</mi><mn>1</mn></mrow></msup><msup><mi>y</mi><mrow><mi>u</mi><mn>2</mn></mrow></msup><mo stretchy="false">)</mo><mi>m</mi><mi>o</mi><mi>d</mi><mi>p</mi><mo stretchy="false">]</mo><mi>m</mi><mi>o</mi><mi>d</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">v=[(g^{u1}y^{u2})mod p]mod q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mclose">]</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span></p>
<p>正确性证明：</p>
<p>验证：如 v=r ′则签名有效</p>
<p>其中M ′,r ′,s ′ 为接收端得到的M,r,s版本</p>
<h3 id="0x04-密钥协商协议">0x04 密钥协商协议</h3>
<h4 id="万物基于DH协议：">万物基于DH协议：</h4>
<blockquote>
<p>在素数阶群G上选择生成元<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span></p>
<p>1.Alice -&gt; Bob: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>g</mi><mi>x</mi></msup></mrow><annotation encoding="application/x-tex">g^x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.858832em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span></p>
<p>2.Bob -&gt;Alice: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>g</mi><mi>y</mi></msup></mrow><annotation encoding="application/x-tex">g^y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.858832em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span></span></span></span></span></span></span></p>
<p>3.both compute the secret key <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>=</mo><msup><mi>g</mi><mrow><mi>x</mi><mi>y</mi></mrow></msup><mo>=</mo><mo stretchy="false">(</mo><msup><mi>g</mi><mi>x</mi></msup><msup><mo stretchy="false">)</mo><mi>y</mi></msup><mo>=</mo><mo stretchy="false">(</mo><msup><mi>g</mi><mi>y</mi></msup><msup><mo stretchy="false">)</mo><mi>x</mi></msup></mrow><annotation encoding="application/x-tex">K = g^{xy}=(g^x)^y=(g^y)^x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.858832em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span></p>
<p>注：不能防止中间人攻击</p>
</blockquote>
<h4 id="HMQV协议：">HMQV协议：</h4>
<p><img src="https://cdn.jsdelivr.net/gh/lowbee2019/PicGo@master/img/Xnip2020-06-20_16-07-33.jpg" alt=""></p>
<blockquote>
<p>Alice 和Bob的公钥分别是：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><msup><mi>g</mi><mi>a</mi></msup><mo separator="true">,</mo><mi>B</mi><mo>=</mo><msup><mi>g</mi><mi>b</mi></msup></mrow><annotation encoding="application/x-tex">A=g^a,B=g^b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.043548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span></span></span></span></span></span></span></span></p>
<p>1.Alice -&gt; Bob: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><msup><mi>g</mi><mi>x</mi></msup></mrow><annotation encoding="application/x-tex">X=g^x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.858832em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span></p>
<p>2.Bob -&gt;Alice: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><msup><mi>g</mi><mi>y</mi></msup></mrow><annotation encoding="application/x-tex">Y=g^y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.858832em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span></span></span></span></span></span></span></p>
<p>3.both compute : <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi mathvariant="normal">&quot;</mi><mi>B</mi><mi>o</mi><mi>b</mi><mi mathvariant="normal">&quot;</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>e</mi><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>Y</mi><mo separator="true">,</mo><mi mathvariant="normal">&quot;</mi><mi>A</mi><mi>l</mi><mi>i</mi><mi>c</mi><mi>e</mi><mi mathvariant="normal">&quot;</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d=H(X,&quot;Bob&quot;),e=H(Y,&quot;Alice&quot;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">&quot;</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal">o</span><span class="mord mathnormal">b</span><span class="mord">&quot;</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">&quot;</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">i</span><span class="mord mathnormal">c</span><span class="mord mathnormal">e</span><span class="mord">&quot;</span><span class="mclose">)</span></span></span></span></p>
<p>4.both compute: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><msup><mi>g</mi><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mi>d</mi><mi>a</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>y</mi><mo>+</mo><mi>e</mi><mi>d</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">σ=g^{(x+da)(y+ed)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0824399999999998em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">a</span><span class="mclose mtight">)</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">d</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li>
<p>for Alice:<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><mo stretchy="false">(</mo><mi>Y</mi><msup><mi>B</mi><mi>e</mi></msup><msup><mo stretchy="false">)</mo><mrow><mi>x</mi><mo>+</mo><mi>d</mi><mi>a</mi></mrow></msup></mrow><annotation encoding="application/x-tex">σ=(YB^e)^{x+da}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0991079999999998em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">a</span></span></span></span></span></span></span></span></span></span></span></span></p>
</li>
<li>
<p>for Bob: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><mo stretchy="false">(</mo><mi>X</mi><msup><mi>A</mi><mi>d</mi></msup><msup><mo stretchy="false">)</mo><mrow><mi>y</mi><mo>+</mo><mi>e</mi><mi>b</mi></mrow></msup></mrow><annotation encoding="application/x-tex">σ=(XA^d)^{y+eb}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">b</span></span></span></span></span></span></span></span></span></span></span></span></p>
</li>
</ul>
<p>5.get session key <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>σ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">K = H(σ)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mclose">)</span></span></span></span></p>
</blockquote>
<h4 id="OPAQUE协议过程："><a target="_blank" rel="noopener" href="https://github.com/lowbee2019/OPAQUE">OPAQUE协议过程</a>：</h4>
<p>OPAQUE 可以有两种实例化方法，分别是HMQV和SIGMA-I；</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Instantiation with HMQV</span><br><span class="line"></span><br><span class="line">   The integration of OPAQUE with HMQV leads to the most efficient instantiation of OPAQUE in terms of exponentiation count.Performance is close to optimal due to the low cost of authentication in HMQV: Just 1/6 of an exponentiation for each party over the cost of a regular DH exchange.  The private and public keys of the parties are Diffie-Hellman keys, namely, PubU=g^PrivU and PubS=g^PrivS.The HMQV exchange can be represented schematically as follows:</span><br><span class="line"></span><br><span class="line">   o  KE1 = g^x</span><br><span class="line"></span><br><span class="line">   o  KE2 = g^y, Mac(Km1; g^x, g^y)</span><br><span class="line"></span><br><span class="line">   o  KE3 = Mac(Km2; g^y, g^x)</span><br><span class="line"></span><br><span class="line">   Keys in HMQV, namely, MAC keys Km1, Km2 and session/traffic keys are derived from a common key K computed as follows:</span><br><span class="line"></span><br><span class="line">   C computes K = H((g^y <span class="emphasis">* PubS^e)^&#123;x + d*</span>PrivU))</span><br><span class="line"></span><br><span class="line">   S computes K = H((g^x <span class="emphasis">* PubU^d)^&#123;y + e*</span>PrivS))</span><br><span class="line"></span><br><span class="line">   where d = H(g^x, IdS) and e = H(g^y, IdU), and IdU, IdS represent the identities of user and server (typically, a user id and domain name, respectively, and can include the party&#x27;s public key value). The function H can be the same as used for the DH-OPRF computation. Using multi-exponentiation optimization, the computation of K involves a single multi-exponentiation whose cost is only 17% more than a regular exponentiation.</span><br></pre></td></tr></table></figure>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Instantiation with SIGMA-I</span><br><span class="line"></span><br><span class="line">   We show how OPAQUE can be built around the 3-message SIGMA-I protocol. This example is significant as it shows integration with a signature-based KE protocol and because TLS 1.3 follows the design of SIGMA-I hence the example helps understanding the proposed integration of OPAQUE with TLS in [RFC8446].SIGMA-I can be represented schematically as follows:</span><br><span class="line"></span><br><span class="line">   o  KE1 = g^x</span><br><span class="line"></span><br><span class="line">   o  KE2 = g^y, Sig(PrivS; g^x, g^y), Mac(Km1; IdS)</span><br><span class="line"></span><br><span class="line">   o  KE3 = Sig(PrivU; g^y, g^x), Mac(Km2; IdU)</span><br><span class="line"></span><br><span class="line">   In this case, the private keys of user and server are signature keys. Key derivation is based on the DH value g^xy. As before, this is only a skeleton to illustrate the protocol. Full details need to be filled in for a self-contained specification.</span><br><span class="line">See also Section 4 for the integration of SIGMA in TLS 1.3.</span><br></pre></td></tr></table></figure>
<h3 id="0x05-病毒-WIFI协议-Kerberos">0x05 病毒 &amp; WIFI协议 &amp; Kerberos</h3>
<ul>
<li>
<h4 id="计算机病毒的生命周期：潜伏阶段，传播阶段、触发阶段、发作阶段">计算机病毒的生命周期：潜伏阶段，传播阶段、触发阶段、发作阶段</h4>
</li>
<li>
<h4 id="WIFI认证方式：WPA、WPA2、WPA-PSK、WPA2-PSK">WIFI认证方式：WPA、WPA2、WPA-PSK、WPA2-PSK</h4>
</li>
<li>
<h4 id="Kerberos">Kerberos</h4>
<blockquote>
<ul>
<li>AS（Authentication Server）= 认证服务器</li>
<li>KDC（Key Distribution Center）= 密钥分发中心</li>
<li>TGT（Ticket Granting Ticket）= 票据授权票据，票据的票据</li>
<li>TGS（Ticket Granting Server）= 票据授权服务器</li>
<li>SS（Service Server）= 特定服务提供端</li>
</ul>
</blockquote>
<p>协议过程：</p>
<p><img src="https://cdn.jsdelivr.net/gh/lowbee2019/PicGo@master/img/Kerberos.jpg" alt=""></p>
<blockquote>
<p>根据上图看协议过程：</p>
<h4 id="第一次请求服务">第一次请求服务</h4>
<ul>
<li>
<p>Client与AS进行身份认证：AS判断Client是否合法，是否有资格享用服务，如果认证通过，AS给Client享受TGS服务的许可证(a ticket for getting tickets)</p>
</li>
<li>
<p>Client和TGS进行身份认证：TGS给Client享用SS服务的许可证(ticket)</p>
</li>
<li>
<p>Client 使用SS提供的服务：出示ticket，使用SS提供的服务</p>
</li>
</ul>
<h4 id="此后请求服务：">此后请求服务：</h4>
<ul>
<li>Client和TGS进行身份认证：TGS给Client享用SS服务的许可证(ticket’)</li>
<li>Client 使用SS提供的服务：出示ticket’，使用SS提供的服务</li>
</ul>
<p>注：TGS的作用是避免用户每次请求SS服务时，都需要进行身份认证；通俗理解是，购买火车票，只有在第一次买票的时候需要先上传身份信息后买票；以后买票可直接购票，省去认证过程。</p>
</blockquote>
</li>
</ul>
<h3 id="0x06-电子交易协议-身份认证">0x06 电子交易协议 &amp; 身份认证</h3>
<h4 id="安全电子交易协议SET：">安全电子交易协议<a target="_blank" rel="noopener" href="https://wenku.baidu.com/view/540641ed7e1cfad6195f312b3169a4517623e55b.html">SET</a>：</h4>
<h5 id="SET协议主要定义了以下内容：">SET协议主要定义了以下内容：</h5>
<ul>
<li>加密算法(如RSA和DES)的应用</li>
<li>证书消息和对象格式</li>
<li>购买消息和对象格式</li>
<li>请款消息和对象格式</li>
<li>参与者之间的消息协议</li>
</ul>
<h5 id="SET是一个基于可信的第三方认证中心的方案，主要服务如下：">SET是一个基于可信的第三方认证中心的方案，<a href="%5Bhttps://baike.baidu.com/item/SET%E5%8D%8F%E8%AE%AE/5054617?fr=aladdin%5D(https://baike.baidu.com/item/SET%E5%8D%8F%E8%AE%AE/5054617?fr=aladdin)">主要服务</a>如下：</h5>
<ul>
<li>
<p>保证客户交易信息的保密性和完整性：双重签名技术。</p>
</li>
<li>
<p>确保商户和客户交易行为的不可否认性：X.509电子证书标准，<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D">数字签名</a>，<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%8A%A5%E6%96%87%E6%91%98%E8%A6%81">报文摘要</a>，双重签名等技术。</p>
</li>
<li>
<p>确保商家和客户的合法性：数字证书。</p>
<p>SET协议保证了电子交易的<strong>机密性、数据完整性、身份的合法性和不可否认性</strong>。</p>
</li>
</ul>
<h5 id="SET协议的主要技术：">SET协议的主要技术：</h5>
<p>首先生成两条消息的摘要，将两个摘要连接起来，生成一个新的摘要，再对新摘要进行签名。<strong>双重</strong>体现在两条消息摘要。</p>
<p><img src="https://cdn.jsdelivr.net/gh/lowbee2019/PicGo@master/img/SET.gif" alt=""></p>
<p><strong>参考</strong>：<a target="_blank" rel="noopener" href="https://wenku.baidu.com/view/4b02856c667d27284b73f242336c1eb91a37339f.html">安全电子交易</a> <a href="%5Bhttps://baike.baidu.com/item/SET%E5%8D%8F%E8%AE%AE/5054617?fr=aladdin%5D(https://baike.baidu.com/item/SET%E5%8D%8F%E8%AE%AE/5054617?fr=aladdin)">百度百科</a></p>
<h4 id="消息认证：数据源认证">消息认证：数据源认证</h4>
<blockquote>
<p>是指从某个声称的源(发送者 Bob)到接收者(验证者Alice)的消息传输过程，该接收者在 接收时会验证消息。其验证的目的有三:<br>
1.确认消息发送者(Bob)身份的真实性<br>
2.确认在原消息离开消息发送者之后的数据完整性<br>
3.确认传输过来的消息的“新鲜性”</p>
</blockquote>
<p>新鲜性：基于时间戳、基于随机数</p>
<p>真实性：公钥体制(数字签名)、对称密钥加密(AES,IDEA等)、消息验证码(RIPE-MAC、HMAC)</p>
<blockquote>
<p>消息认证&amp;数据完整性</p>
<ul>
<li>消息认证:验证消息是否真实、是否新鲜</li>
<li>数据完整性:验证消息在传输、存储过程中未经非法修改</li>
</ul>
<p><strong>消息认证是身份认证的基础</strong></p>
<p>当实体声称的身份信息单独构成协议消息时，身份认证=消息认证</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/lowbee2019/PicGo@master/img/20200617195229.png" alt="三者关系"></p>
<h4 id="身份认证：">身份认证：</h4>
<p>目的：确认通信主体之间身份的真实性(只是数字身份的真实性)、防止主动攻击。</p>
<p>重要性：是保障信息系统安全的第一道防线</p>
<p>手段：基于用户名-口令的认证、基于摘要算法的认证，基于PKI的认证</p>
<h3 id="0x07-安全模型">0x07 安全模型</h3>
<table>
<thead>
<tr>
<th style="text-align:center">模型</th>
<th style="text-align:center">模型特征</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">BLP</td>
<td style="text-align:center"><strong>保密性</strong>，军事安全，中央集权信息系统、较低的执行开销</td>
</tr>
<tr>
<td style="text-align:center">BIBA</td>
<td style="text-align:center"><strong>完整性</strong>，强制访问控制，难于应用，中央集权信息系统</td>
</tr>
<tr>
<td style="text-align:center">Clark-Wilson</td>
<td style="text-align:center"><strong>完整性</strong>，商业安全，能够应用面向对象系统，与应用无关的策略、灵活</td>
</tr>
<tr>
<td style="text-align:center">Chinese Wall</td>
<td style="text-align:center"><strong>保密性</strong>，金融制度，可能有负作用，安全管理的开销较大</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>BLP模型基于两种规则来保障数据的机密度和敏感度？</p>
<p>下读：主体不可读安全级别高于她的数据</p>
<p>上写：主体不可写安全级别低于它的数据</p>
</li>
<li>
<p>BIBA模型基于两种规则来保障数据的完整性与保密性？（下读上写）</p>
<p>上读：主体不可读安全级别低于它的数据</p>
<p>下写：主体不可写安全级别高于它的数据</p>
</li>
<li>
<p>多边安全模型？Chinese wall和BMA</p>
</li>
<li>
<p>哪些模型可以提供机密性保护？BLP，Chinese Wall</p>
</li>
<li>
<p>哪些模型可以提供完整性保护？BIBA、Clark-Wilson</p>
</li>
</ul>
<h2 id="0x08-可信计算">0x08 可信计算</h2>
<h4 id="概念与需求：">概念与需求：</h4>
<p><strong>安全</strong>是指采取技术和管理的安全保护手段，保护软硬件与数据不 因偶然的或恶意的原因而遭受到破坏、更改、暴露。</p>
<table>
<thead>
<tr>
<th style="text-align:left">Secure</th>
<th>Trusted</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Binary</td>
<td>Graded</td>
</tr>
<tr>
<td style="text-align:left">Property of presenter</td>
<td>Property of receiver</td>
</tr>
<tr>
<td style="text-align:left">Asserted, based on characteristics</td>
<td>Judged, based on evidence</td>
</tr>
<tr>
<td style="text-align:left">Absolute</td>
<td>Relative</td>
</tr>
<tr>
<td style="text-align:left">Goal</td>
<td>Characteristic</td>
</tr>
</tbody>
</table>
<h4 id="可信计算的涵义：">可信计算的涵义：</h4>
<p><strong>用户的身份认证</strong>:这是对使用者的信任。<br>
<strong>平台软硬件配置的正确性</strong>:这体现了使用者对平台运行环境的信任。<br>
<strong>应用程序的完整性和合法性</strong>:这体现了应用程序运行的可信。<br>
<strong>平台之间的可验证性</strong>:指网络环境下平台之间的相互信任。</p>
<h4 id="可信计算的属性：">可信计算的属性：</h4>
<p><strong>可鉴别</strong>:计算机系统的用户可以确定与他们进行通信的对象身份。<br>
<strong>完整性</strong>:用户确保信息能被正确传输。<br>
<strong>私密性</strong>:用户相信系统能保证信息的私密性。</p>
<h4 id="TPM：可信任平台模块-可信计算核心">TPM：可信任平台模块(可信计算核心)</h4>
<p><strong>TCG技术的核心内容就是为计算平台提供了一整套基于TPM及平台中TBB (平台可信构造块=TPM+CRTM)的信任建立及可信性证实方法和机制</strong></p>
<p>TPM至少具备四个主要功能：</p>
<ul>
<li>对称/非对称加密：对称加密算法可以任选，数据的非对称加密是RSA算法。</li>
<li>安全存储</li>
<li>完整性度量：SHA-1散列算法</li>
<li>签名认证：RSA算法</li>
</ul>
<h4 id="TCSEC：美国可信计算机系统评价标准"><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/TCSEC/8878477?fr=aladdin">TCSEC</a>：美国<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%8F%AF%E4%BF%A1%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/9681955">可信计算机系统</a>评价标准</h4>
<blockquote>
<h3 id="D类安全等级">D类安全等级</h3>
<p>D类安全等级只包括D1一个级别。D1的安全等级最低。D1系统只为文件和用户提供安全保护。D1系统最普通的形式是本地操作系统，或者是一个完全没有保护的网络。</p>
<h3 id="C类安全等级">C类安全等级</h3>
<p>该类安全等级能够提供审计的保护，并为用户的行动和责任提供审计能力。C类安全等级可划分为C1和C2两类。C1系统的可信任运算基础体制（Trusted Computing Base，TCB）通过将用户和数据分开来达到安全的目的。在C1系统中，所有的用户以同样的灵敏度来处理数据，即用户认为C1系统中的所有文档都具有相同的机密性。C2系统比C1系统加强了可调的审慎控制。在连接到网络上时，C2系统的用户分别对各自的行为负责。C2系统通过登陆过程、安全事件和资源隔离来增强这种控制。C2系统具有C1系统中所有的安全性特征。</p>
<h3 id="B类安全等级">B类安全等级</h3>
<p>B类安全等级可分为B1、B2和B3三类。B类系统具有强制性保护功能。强制性保护意味着如果用户没有与安全等级相连，系统就不会让用户存取对象。B1系统满足下列要求：系统对<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E7%BD%91%E7%BB%9C%E6%8E%A7%E5%88%B6">网络控制</a>下的每个对象都进行灵敏度标记；系统使用灵敏度标记作为所有强迫<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6/8545517">访问控制</a>的基础；系统在把导入的、非标记的对象放入系统前标记它们；灵敏度标记必须准确地表示其所联系的对象的安全级别;当<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%91%98">系统管理员</a>创建系统或者增加新的通信通道或<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/I%2FO%E8%AE%BE%E5%A4%87/9688581">I/O设备</a>时，管理员必须指定每个通信通道和I/O设备是单级还是多级，并且管理员只能手工改变指定;单级设备并不保持传输信息的灵敏度级别;所有直接面向用户位置的输出（无论是虚拟的还是物理的）都必须产生标记来指示关于输出对象的灵敏度;系统必须使用用户的口令或证明来决定用户的安全访问级别;系统必须通过审计来记录未授权访问的企图。</p>
<p>B2系统必须满足B1系统的所有要求。另外，B2系统的管理员必须使用一个明确的、文档化的<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%AE%89%E5%85%A8%E7%AD%96%E7%95%A5/2890163">安全策略</a>模式作为系统的可信任运算基础体制。B2系统必须满足下列要求：系统必须立即通知系统中的每一个用户所有与之相关的网络连接的改变；只有用户能够在可信任通信路径中进行初始化通信；可信任运算基础体制能够支持独立的操作者和管理员。</p>
<p>B3系统必须符合B2系统的所有安全需求。B3系统具有很强的监视委托管理访问能力和抗干扰能力。B3系统必须设有安全管理员。B3系统应满足以下要求:除了控制对个别对象的访问外，</p>
<p>B3必须产生一个可读的安全列表；每个被命名的对象提供对该对象没有访问权的用户列表说明;B3系统在进行任何操作前，要求用户进行<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81">身份验证</a>；B3系统验证每个用户，同时还会发送一个取消访问的<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%AE%A1%E8%AE%A1%E8%B7%9F%E8%B8%AA">审计跟踪</a>消息；设计者必须正确区分可信任的通信路径和其他路径；可信任的通信基础体制为每一个被命名的对象建立<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%AE%89%E5%85%A8%E5%AE%A1%E8%AE%A1">安全审计</a>跟踪；可信任的运算基础体制支持独立的安全管理。</p>
<h3 id="A类安全等级">A类安全等级</h3>
<p>A系统的安全级别最高。A类安全等级只包含A1一个安全类别。A1类与B3类相似，对系统的结构和策略不作特别要求。A1系统的显著特征是，系统的设计者必须按照一个正式的设计规范来分析系统。对系统分析后，设计者必须运用核对技术来确保系统符合设计规范。A1系统必须满足下列要求：<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%91%98">系统管理员</a>必须从开发者那里接收到一个<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%AE%89%E5%85%A8%E7%AD%96%E7%95%A5/2890163">安全策略</a>的正式模型;所有的安装操作都必须由系统管理员进行；系统管理员进行的每一步安装操作都必须有正式文档。</p>
</blockquote>
<p>四类七级:<strong>A1</strong>最安全。</p>
<h4 id="CC：国际通用标准"><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/cc/2116178?fr=aladdin">CC</a>：国际通用标准</h4>
<p>CC是国际标准化组织统一现有多种准则的结果，是目前最全面的评价准则。</p>
<blockquote>
<p>EAL1：功能测试级。适用在对正确运行要求有一定信心的场合，此场合下认为安全威胁并不严重。个人信息保护就是其中一例。</p>
<p>EAL2：结构测试级。在交付设计信息和测试结果时，需要开发人员的合作。但在超出良好的商业运作的一致性方面，不要花费过多的精力。</p>
<p>EAL3：系统测试和检查级。在不大量更改已有合理才开发实现的前提下，允许一位尽责的开发人员在设计阶段从正确的安全工程中获得最大限度的保证。</p>
<p>EAL4：系统设计，测试和复查级。它使开发人员从正确的安全工程中获得最大限度的保证，这种安全工程基于良好的商业开发实践，这种实践很严格，但并不需要大量专业知识，技巧和其他资源。在经济合理的条件下，对一个已经存在的生产线进行翻新时，EAL4是所能达到的最高级别。2002年，Windows 2000 成为第一种获得EAL4认证的<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F">操作系统</a>，这表明它已经达到了民用产品应该具有的评价保证级别。</p>
<p>EAL5：半形式化设计和测试级。开发者能从安全工程中获得最大限度的安全保证，该安全工程是基于严格的商业开发实践，靠适度应用专业安全工程技术来支持的。EAL5以上的级别是军用信息设备，用于<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%85%AC%E5%BC%80%E5%AF%86%E9%92%A5">公开密钥</a>基础设施的信息设备应达到的标准。</p>
<p>EAL6：半形式化验证设计和测试级。开发者通过安全工程技术的应用和严格的开发环境获得高度的认证，保护高价值的资产能够对抗重大风险。</p>
<p>EAL7：形式化验证设计和测试级。适用于风险非常高或有高价值资产值得更高开销的地方。</p>
</blockquote>
<p><strong>EAL7</strong>表示安全等级最高。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Low Bee</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://lowbee.fun/2020/06/16/%E4%BF%A1%E6%81%AF%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E5%AD%A6%E4%B9%A0/">http://lowbee.fun/2020/06/16/%E4%BF%A1%E6%81%AF%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E5%AD%A6%E4%B9%A0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E4%B8%93%E4%B8%9A/">专业</a><a class="post-meta__tags" href="/tags/%E5%8D%8F%E8%AE%AE/">协议</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/lowbee2019/PicGo@master/img/bg1.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> Donate</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-full"><a href="/2020/06/17/%E4%B8%80%E4%B8%AA%E5%8D%95%E7%BA%AF%E7%9A%84%E6%96%87%E6%A1%A3/"><img class="prev-cover" src="https://cdn.jsdelivr.net/gh/lowbee2019/PicGo@master/img/default.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">一个单纯的文档</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/lowbee2019/PicGo@master/img/头像.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Low Bee</div><div class="author-info__description">科研废物</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">70</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">40</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">8</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/lowbee2019"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/lowbee2019" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:lowbee@vip.qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>Announcement</span></div><div class="announcement_content">社会主义接班人！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%A2%E8%A7%82%E9%A2%98"><span class="toc-number">1.</span> <span class="toc-text">客观题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%89%E6%8B%A9"><span class="toc-number">1.1.</span> <span class="toc-text">选择</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A1%AB%E7%A9%BA"><span class="toc-number">1.2.</span> <span class="toc-text">填空</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%A2%E8%A7%82%E9%A2%98%E6%95%B4%E7%90%86-%E6%84%9F%E8%B0%A2-Steve%C2%B7Curcy"><span class="toc-number">1.3.</span> <span class="toc-text">客观题整理 感谢@Steve·Curcy</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E8%A7%82%E9%A2%98"><span class="toc-number">2.</span> <span class="toc-text">主观题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#0x01-%E8%AF%BE%E5%A0%82%E6%B1%87%E6%8A%A5-%E6%B5%81%E5%AF%86%E7%A0%81"><span class="toc-number">2.1.</span> <span class="toc-text">0x01 课堂汇报(流密码)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9A"><span class="toc-number">2.1.1.</span> <span class="toc-text">是什么：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88"><span class="toc-number">2.1.2.</span> <span class="toc-text">为什么:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%B9%E7%82%B9%EF%BC%9A"><span class="toc-number">2.1.3.</span> <span class="toc-text">特点：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%98%E7%BC%BA%E7%82%B9%EF%BC%9A"><span class="toc-number">2.1.4.</span> <span class="toc-text">优缺点：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x02-%E5%90%8D%E8%AF%8D%E8%A7%A3%E9%87%8A"><span class="toc-number">2.2.</span> <span class="toc-text">0x02 名词解释</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x03-%E9%9B%B6%E7%9F%A5%E8%AF%86%E8%AF%81%E6%98%8E-FS%E9%89%B4%E5%88%AB%E5%8D%8F%E8%AE%AE-DSA"><span class="toc-number">2.3.</span> <span class="toc-text">0x03 零知识证明 &amp; FS鉴别协议 &amp; DSA</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9B%B6%E7%9F%A5%E8%AF%86%E8%AF%81%E6%98%8E%EF%BC%9A"><span class="toc-number">2.3.1.</span> <span class="toc-text">零知识证明：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Fiat-Shamir%E9%89%B4%E5%88%AB%E5%8D%8F%E8%AE%AE%EF%BC%9A"><span class="toc-number">2.3.2.</span> <span class="toc-text">Fiat-Shamir鉴别协议：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%B2%E8%BF%B0%E4%B8%80%E4%B8%AA-%E4%B8%8D%E5%8F%AF%E8%83%BD-%E7%9A%84%E6%95%85%E4%BA%8B"><span class="toc-number">2.3.3.</span> <span class="toc-text">讲述一个&quot;不可能&quot;的故事</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%BC%E4%B8%8A%E4%B8%A4%E7%A7%8D%E6%83%85%E5%86%B5%E5%8F%AF%E8%A7%81-A-%E5%9C%A8%E4%B8%8D%E7%9F%A5%E9%81%93%E7%A7%98%E5%AF%86s%E7%9A%84%E6%83%85%E5%86%B5%E4%B8%8B%EF%BC%8C%E6%9C%891-2%E7%9A%84%E6%A6%82%E7%8E%87%E6%88%90%E5%8A%9F%EF%BC%8C%E6%89%80%E4%BB%A5%E6%AD%A4%E5%8D%8F%E8%AE%AE%E9%9C%80%E8%A6%81n%E6%AC%A1%E6%8C%91%E6%88%98-A%E6%88%90%E5%8A%9F%E6%AC%BA%E9%AA%97%E7%9A%84%E6%A6%82%E7%8E%87%E5%B0%B1%E6%98%AF1-2-n%E3%80%82"><span class="toc-number">2.3.4.</span> <span class="toc-text">综上两种情况可见,A 在不知道秘密s的情况下，有1&#x2F;2的概率成功，所以此协议需要n次挑战,A成功欺骗的概率就是1&#x2F;2n1&#x2F;2^n1&#x2F;2n。</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DSA%EF%BC%9A"><span class="toc-number">2.3.5.</span> <span class="toc-text">DSA：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x04-%E5%AF%86%E9%92%A5%E5%8D%8F%E5%95%86%E5%8D%8F%E8%AE%AE"><span class="toc-number">2.4.</span> <span class="toc-text">0x04 密钥协商协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%87%E7%89%A9%E5%9F%BA%E4%BA%8EDH%E5%8D%8F%E8%AE%AE%EF%BC%9A"><span class="toc-number">2.4.1.</span> <span class="toc-text">万物基于DH协议：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HMQV%E5%8D%8F%E8%AE%AE%EF%BC%9A"><span class="toc-number">2.4.2.</span> <span class="toc-text">HMQV协议：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#OPAQUE%E5%8D%8F%E8%AE%AE%E8%BF%87%E7%A8%8B%EF%BC%9A"><span class="toc-number">2.4.3.</span> <span class="toc-text">OPAQUE协议过程：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x05-%E7%97%85%E6%AF%92-WIFI%E5%8D%8F%E8%AE%AE-Kerberos"><span class="toc-number">2.5.</span> <span class="toc-text">0x05 病毒 &amp; WIFI协议 &amp; Kerberos</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%97%85%E6%AF%92%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%EF%BC%9A%E6%BD%9C%E4%BC%8F%E9%98%B6%E6%AE%B5%EF%BC%8C%E4%BC%A0%E6%92%AD%E9%98%B6%E6%AE%B5%E3%80%81%E8%A7%A6%E5%8F%91%E9%98%B6%E6%AE%B5%E3%80%81%E5%8F%91%E4%BD%9C%E9%98%B6%E6%AE%B5"><span class="toc-number">2.5.1.</span> <span class="toc-text">计算机病毒的生命周期：潜伏阶段，传播阶段、触发阶段、发作阶段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WIFI%E8%AE%A4%E8%AF%81%E6%96%B9%E5%BC%8F%EF%BC%9AWPA%E3%80%81WPA2%E3%80%81WPA-PSK%E3%80%81WPA2-PSK"><span class="toc-number">2.5.2.</span> <span class="toc-text">WIFI认证方式：WPA、WPA2、WPA-PSK、WPA2-PSK</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Kerberos"><span class="toc-number">2.5.3.</span> <span class="toc-text">Kerberos</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E6%AC%A1%E8%AF%B7%E6%B1%82%E6%9C%8D%E5%8A%A1"><span class="toc-number">2.5.4.</span> <span class="toc-text">第一次请求服务</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AD%A4%E5%90%8E%E8%AF%B7%E6%B1%82%E6%9C%8D%E5%8A%A1%EF%BC%9A"><span class="toc-number">2.5.5.</span> <span class="toc-text">此后请求服务：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x06-%E7%94%B5%E5%AD%90%E4%BA%A4%E6%98%93%E5%8D%8F%E8%AE%AE-%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81"><span class="toc-number">2.6.</span> <span class="toc-text">0x06 电子交易协议 &amp; 身份认证</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E7%94%B5%E5%AD%90%E4%BA%A4%E6%98%93%E5%8D%8F%E8%AE%AESET%EF%BC%9A"><span class="toc-number">2.6.1.</span> <span class="toc-text">安全电子交易协议SET：</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#SET%E5%8D%8F%E8%AE%AE%E4%B8%BB%E8%A6%81%E5%AE%9A%E4%B9%89%E4%BA%86%E4%BB%A5%E4%B8%8B%E5%86%85%E5%AE%B9%EF%BC%9A"><span class="toc-number">2.6.1.1.</span> <span class="toc-text">SET协议主要定义了以下内容：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#SET%E6%98%AF%E4%B8%80%E4%B8%AA%E5%9F%BA%E4%BA%8E%E5%8F%AF%E4%BF%A1%E7%9A%84%E7%AC%AC%E4%B8%89%E6%96%B9%E8%AE%A4%E8%AF%81%E4%B8%AD%E5%BF%83%E7%9A%84%E6%96%B9%E6%A1%88%EF%BC%8C%E4%B8%BB%E8%A6%81%E6%9C%8D%E5%8A%A1%E5%A6%82%E4%B8%8B%EF%BC%9A"><span class="toc-number">2.6.1.2.</span> <span class="toc-text">SET是一个基于可信的第三方认证中心的方案，主要服务如下：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#SET%E5%8D%8F%E8%AE%AE%E7%9A%84%E4%B8%BB%E8%A6%81%E6%8A%80%E6%9C%AF%EF%BC%9A"><span class="toc-number">2.6.1.3.</span> <span class="toc-text">SET协议的主要技术：</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B6%88%E6%81%AF%E8%AE%A4%E8%AF%81%EF%BC%9A%E6%95%B0%E6%8D%AE%E6%BA%90%E8%AE%A4%E8%AF%81"><span class="toc-number">2.6.2.</span> <span class="toc-text">消息认证：数据源认证</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%EF%BC%9A"><span class="toc-number">2.6.3.</span> <span class="toc-text">身份认证：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x07-%E5%AE%89%E5%85%A8%E6%A8%A1%E5%9E%8B"><span class="toc-number">2.7.</span> <span class="toc-text">0x07 安全模型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x08-%E5%8F%AF%E4%BF%A1%E8%AE%A1%E7%AE%97"><span class="toc-number">3.</span> <span class="toc-text">0x08 可信计算</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5%E4%B8%8E%E9%9C%80%E6%B1%82%EF%BC%9A"><span class="toc-number">3.0.1.</span> <span class="toc-text">概念与需求：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%AF%E4%BF%A1%E8%AE%A1%E7%AE%97%E7%9A%84%E6%B6%B5%E4%B9%89%EF%BC%9A"><span class="toc-number">3.0.2.</span> <span class="toc-text">可信计算的涵义：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%AF%E4%BF%A1%E8%AE%A1%E7%AE%97%E7%9A%84%E5%B1%9E%E6%80%A7%EF%BC%9A"><span class="toc-number">3.0.3.</span> <span class="toc-text">可信计算的属性：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#TPM%EF%BC%9A%E5%8F%AF%E4%BF%A1%E4%BB%BB%E5%B9%B3%E5%8F%B0%E6%A8%A1%E5%9D%97-%E5%8F%AF%E4%BF%A1%E8%AE%A1%E7%AE%97%E6%A0%B8%E5%BF%83"><span class="toc-number">3.0.4.</span> <span class="toc-text">TPM：可信任平台模块(可信计算核心)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#TCSEC%EF%BC%9A%E7%BE%8E%E5%9B%BD%E5%8F%AF%E4%BF%A1%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E8%AF%84%E4%BB%B7%E6%A0%87%E5%87%86"><span class="toc-number">3.0.5.</span> <span class="toc-text">TCSEC：美国可信计算机系统评价标准</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#D%E7%B1%BB%E5%AE%89%E5%85%A8%E7%AD%89%E7%BA%A7"><span class="toc-number">3.1.</span> <span class="toc-text">D类安全等级</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#C%E7%B1%BB%E5%AE%89%E5%85%A8%E7%AD%89%E7%BA%A7"><span class="toc-number">3.2.</span> <span class="toc-text">C类安全等级</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#B%E7%B1%BB%E5%AE%89%E5%85%A8%E7%AD%89%E7%BA%A7"><span class="toc-number">3.3.</span> <span class="toc-text">B类安全等级</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#A%E7%B1%BB%E5%AE%89%E5%85%A8%E7%AD%89%E7%BA%A7"><span class="toc-number">3.4.</span> <span class="toc-text">A类安全等级</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CC%EF%BC%9A%E5%9B%BD%E9%99%85%E9%80%9A%E7%94%A8%E6%A0%87%E5%87%86"><span class="toc-number">3.4.1.</span> <span class="toc-text">CC：国际通用标准</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/12/20/Paper-33/" title="ClusterGAN: Latent Space Clustering in Generative Adversarial Networks"><img src="https://cdn.jsdelivr.net/gh/lowbee2019/PicGo@master/img/default.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ClusterGAN: Latent Space Clustering in Generative Adversarial Networks"/></a><div class="content"><a class="title" href="/2021/12/20/Paper-33/" title="ClusterGAN: Latent Space Clustering in Generative Adversarial Networks">ClusterGAN: Latent Space Clustering in Generative Adversarial Networks</a><time datetime="2021-12-20T02:47:34.000Z" title="Created 2021-12-20 10:47:34">2021-12-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/11/26/Reinforcement-Learning-ZouWei-3/" title="Reinforcement Learning ZouWei(III)"><img src="https://cdn.jsdelivr.net/gh/lowbee2019/PicGo@master/img/f5d6603125a166875ed1666ca908e45b.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Reinforcement Learning ZouWei(III)"/></a><div class="content"><a class="title" href="/2021/11/26/Reinforcement-Learning-ZouWei-3/" title="Reinforcement Learning ZouWei(III)">Reinforcement Learning ZouWei(III)</a><time datetime="2021-11-26T01:26:30.000Z" title="Created 2021-11-26 09:26:30">2021-11-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/11/25/Reinforcement-Learning-ZouWei-2/" title="Reinforcement Learning ZouWei(II)"><img src="https://cdn.jsdelivr.net/gh/lowbee2019/PicGo@master/img/f5d6603125a166875ed1666ca908e45b.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Reinforcement Learning ZouWei(II)"/></a><div class="content"><a class="title" href="/2021/11/25/Reinforcement-Learning-ZouWei-2/" title="Reinforcement Learning ZouWei(II)">Reinforcement Learning ZouWei(II)</a><time datetime="2021-11-25T11:24:14.000Z" title="Created 2021-11-25 19:24:14">2021-11-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/11/22/Reinforcement-Learning-ZouWei-1/" title="Reinforcement Learning ZouWei(I)"><img src="https://cdn.jsdelivr.net/gh/lowbee2019/PicGo@master/img/f5d6603125a166875ed1666ca908e45b.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Reinforcement Learning ZouWei(I)"/></a><div class="content"><a class="title" href="/2021/11/22/Reinforcement-Learning-ZouWei-1/" title="Reinforcement Learning ZouWei(I)">Reinforcement Learning ZouWei(I)</a><time datetime="2021-11-22T13:46:09.000Z" title="Created 2021-11-22 21:46:09">2021-11-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/06/17/Paper-32/" title="Federated Evaluation of On-device Personalization"><img src="https://cdn.jsdelivr.net/gh/lowbee2019/PicGo@master/img/default.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Federated Evaluation of On-device Personalization"/></a><div class="content"><a class="title" href="/2021/06/17/Paper-32/" title="Federated Evaluation of On-device Personalization">Federated Evaluation of On-device Personalization</a><time datetime="2021-06-17T13:07:02.000Z" title="Created 2021-06-17 21:07:02">2021-06-17</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://cdn.jsdelivr.net/gh/lowbee2019/PicGo@master/img/bg1.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By Low Bee</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.css"><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', '', 'katex-wrap')
  })
})()</script></div><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="true" data-text="富强,民主,文明,和谐,自由,平等,公正,法治,爱国,敬业,诚信,友善" data-fontsize="15px" data-random="true" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"./live2d_models/haruna/22/model.2017.school.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>